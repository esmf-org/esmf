%============================================================================
% CVS $Id: processes.tex,v 1.9.6.1 2009/12/23 19:35:39 svasquez Exp $
% CVS $Source: /mnt/twixshare/Storage/Archive-SF-Repos/ESMF_CVS_Repo/esmf/src/doc/dev_guide/processes.tex,v $
% CVS $Name:  $
%===============================================================================

\section{Processes}
\label{sec:life_cycle}

The ESMF development environment has several defining characteristics.
First, both the ESMF Core Team and the JST are distributed.  This makes
incorporating simple, efficient communication mechanisms into the
development process essential.  Second, the JST and Core Team work on
a range of different platforms, at sites that don't have the time, resources,
or inclination to install demanding packages.  Collaboration
tools that require no purchase or installation before use are essential.
Finally, ESMF is committed to open development.  As much as possible, 
the ESMF team tries to keep the workings of the project - metrics,
support and bug lists, schedules, task lists, source code, you name it -
visible to the broad community.

\subsection{Software Process Model}

The ESMF software development cycle is based on the staged 
delivery model \cite{mcconnell96}.  The steps in this software development
model are:

\begin{enumerate}
\item {\bf Software Concept}  Collect and itemize the high-level requirements of the system and identify the basic functions that the system must perform.

\item {\bf Requirements Analysis} Write and review a requirements document - a detailed statement of the scientific and computational requirements for the software.

\item {\bf Architectural Design} Define a high-level software architecture that outlines the functions, relationships, and interfaces for major components. Write and review an architecture document.

\item {\bf Stage 1, 2, ..., n} Repeat the following steps creating a potentially releasable product at the end of each stage. Each stage produces a more robust, complete version of the software.

\begin{itemize}
\item {\it Detailed Design} Create a detailed design document and API specification. Incorporate the interface specification 
into a detailed design document and review the design.

\item {\it Code Construction and Unit Testing} Implement the interface, 
debug and unit test.

\item {\it System Testing}  Assemble the complete system, verify that the 
code satisfies all requirements.

\item {\it Release} Create a potentially releasable product, including User's Guide and User's Reference Manual. Frequently code produced at intermediate stages software will be used internally.
\end{itemize}

\item {\bf Code Distribution and Maintenance}  Official public release 
of the software, beginning of maintenance phase. 

\end{enumerate}

We have customized and extended this standard model to suit the ESMF project.
At this stage of ESMF development, we are in the iterative design/implement/release
cycle.  Below are a few notes on earlier stages.  

\subsection{ESMF Process History}

\subsubsection{Software Concept}
Participants in the ESMF project completed the Software Concept
stage in the process of developing a unified set of proposals.
A summary of the high-level requirements of ESMF - a statement of project
scope and vision - is included in the {\it General Requirements}
part of the {\it ESMF Requirements Document}\cite{bib:ESMFreqdoc}.
This was a successful effort in defining the scope of the project
and agreeing to an overall design strategy.

\subsubsection {Requirements Analysis}
The ESMF Team spent about six months at the start of the project
producing the {\it ESMF Requirements Document}.
This outlined the major ESMF capabilities necessary to meet project milestones
and achieve project goals.  The second part of the document was a detailed 
requirements specification for each functionality class included in 
the framework.  This document also included a discussion of the 
process that was used to initially collect requirements.
The {\it Requirements Document} was a useful reference for the development
team, especially for new developers coming in from outside of the
Earth science domain.  However, as the framework matured, support
requests and the Change Review Board process took precedence in defining
development tasks and setting priorities.  The {\it Requirements 
Document} is bundled with the ESMF source distribution through version 2;
with version 3 it was removed.  

\subsubsection{Architectural Design}
The project had difficulty with the {\it Architecture Document}.  
The comments received back on the completed work, informally and
from a peer review body, indicated that the presentation of the document
was ineffective at conveying how the ESMF worked. Although the
document was full of detailed and complex diagrams, the terminology and
diagrams were oriented to software engineers and were not especially
scientist-friendly.  The detailed diagrams also made the document difficult
to maintain.  This experience helped to guide the ESMF project 
towards more user-oriented documents, but it also left a gap in the 
documentation that has taken time to fill.

\subsection{Ongoing Development}

The following are processes the ESMF team is actively following.  These
guidelines apply to core team developers and outside contributors
who will be checking code into the main ESMF repository.

All design and code reviews are telecons held with the JST. 
Telecons are scheduled with the Core Team Manager, put on the ESMF
calendar on the home page of the ESMF website, and announced on the
esmf\_jst@list.woc.noaa.gov list.

\subsubsection{Telecon Etiquette}

When you call in, it's nice to give your name at the first opportunity.
Telecon hosts will make an effort to introduce people on the JST calls,
especially first-timers. Please don't put the telecon on hold (we sometimes
get telecon-stopping music or beeps this way).

Within a week or so after the telecon, the host (the developer if it's a design
or code review) is expected to send out a summary to esmf\_jst@list.woc.noaa.gov
with the date of the call, the participants, and notes or conclusions.

\subsubsection{Design Reviews}

\begin{enumerate}
\item Introductory telecon(s). The point here is to scope out the problem
at hand. These calls cover the following, as they apply.
\begin{itemize}
\item Understand the capability needed and review requirements.
\item Discuss design alternatives.
\item Survey and discuss any existing packages that cover the new functionality.
\item Discuss potential use test cases.
\item Figure out which customers will be involved in use test case development and identify customers that are likely to provide important input
(sometimes we offer a friendly reminder service to these folks before relevant
telecons).
\end{itemize}

For these introductory discussions, any form of material is fine - diagrams,
slides, plain text ramblings, lists of questions, ...

\item Initial design review(s). The document presented should be in the format
of the ESMF Reference Manual, either in plain text or in latex/ProTeX.
This is so the document can be incorporated into project documentation
after implementation. The initial review document should include at least
the following sections:
\begin{itemize}
\item Class description.
\item Use and Examples. Here the examples begin with the very simplest
cases.
\item API sufficient to cover the examples. This is because it can be difficult
to follow the examples (e.g. tell what arguments and options are) without the
basic API entries accompanying them.
\end{itemize}

This step is iterated until developers and customers converge.

\item Full telecon review(s). The developer should prepare the API specification
using latex and ProTex following the conventions in the Reference Manual.
Most of the Reference Manual section(s) for the new or modified class(es),
including Class Options and Restrictions and Future Work, should be available
at the time of this review. Diagrams should be ready here too.

\item Use test case telecon review. For each major piece of functionality, a use
test case is prepared in collaboration with customers and executed before
release. The use test case is performed on a realistic number of processors
and with realistic input data sets.

It doesn't have to work (and probably won't) before it's reviewed, but it
needs to work before the functionality appears in a release. The developer
checks it into the top-level use\_test\_case directory on SourceForge and
prepares a HTML page outlining it for the Test \& Validation page on the
ESMF website. Unlike unit and system tests, use test cases aren't
distributed with the ESMF source.
\end{enumerate}

\subsubsection{Implementation and Test Before Internal Release}

Code should be written in accordance with the interface specifications
agreed to during design reviews and the coding conventions described in 
Section ~\ref{sec:code_conv}.  

There is an internal release checklist on the Test \& Validation page of the
ESMF website that contains an exhaustive listing of develop and tester
responsibilities for releases.  For additional discussion
of test and validation procedures, see Section~\ref{sec:testing}.

The developer is responsible for working with the tester(s) to make sure
that the following are present before an internal release:
\begin{itemize}
\item 100\% unit and system test coverage of new interfaces, with the exception
of interfaces where type/kind/rank is heavily overloaded. All arguments tested
at least once.
\item Use test cases work
\end{itemize}

\subsubsection{Implementation and Test Before Public Release}

There is a public release checklist on the Test \& Validation page of the ESMF
website that contains an exhaustive listing of develop and tester
responsibilities for releases.  For additional discussion
of test and validation procedures, see Section~\ref{sec:testing}.

Same as for internal release, plus:
\begin{itemize}
\item Design and Implementation Notes section for Reference Manual complete.
\item Developer and tester ensure that test coverage for new interfaces is sufficient, implementing any additional tests to make it so. This includes testing of options and tests for error handling and recovery.
\end{itemize}

\subsubsection{Code Check-In}

Developers are encouraged to check their changes into the repository
as they complete them, as frequently as possible without breaking the
existing code base.

\begin{enumerate}
\item Both core and contributors should test on at least three platforms before commit.
\item For core team developers, a mail should go out to esmf\_core@list.woc.noaa.gov
before check-in for very large commits and for commits that will break the
HEAD. For contributors a mail should go out to esmf\_core@list.woc.noaa.gov before
ANY commit.
\item Core team developers can be set up to receive email from SourceForge
for every check-in, by writing esmf\_support@list.woc.noaa.gov with the request.
\end{enumerate}

\subsubsection{Code Reviews}
\begin{enumerate}
\item All significant chunks of externally contributed code are reviewed
by the JST. It's usual to do the code review after check-in. The code review should
be scheduled with the Core Team Manager when the code is checked in, and
the code review held before the next release.
\item We also do code reviews with core team members, as desired/required
by the JST. 
\end{enumerate}

\subsubsection {Releases}

The ESMF produces internal releases and public releases based
on the schedule generated by the CRB.  Every public release
is preceded by an internal release three months prior, for the
purpose of beta testing.  During those three months, bugs may be
fixed and documentation improved, but no new functionality may be
added.  Occasionally the Core Team releases an internal release
that does not become a public release.  This would happen, for 
example, when major changes are being made to ESMF and user
input is needed for multiple preliminary versions of the software.

The Integrator tags new system versions with coherent changes prior
to release.  The tagging convention for public and internal releases is
described in Section~\ref{sec:tagging}.  

Prior to release all ESMF software is regression-tested on all platforms
and interfaces.  The Integrator is responsible for regression testing,
identifying problems and notifying the appropriate developers, and 
collecting and sending out Release Notes and Known Bugs.

ESMF releases are announced
on the esmf\_jst@list.woc.noaa.gov mailing list and are posted on the ESMF
website.  Source code is available for download from the ESMF
website and from the main ESMF SourceForge site.

\subsubsection{Backups}

The ESMF SourceForge repository is backed up nightly.  The tarball
from this backup is downloaded on a weekly basis and stored on a local
machine, currently an IBM at NCAR.











