% $Id: ESMF_infradataoverview.tex,v 1.9 2004/03/22 17:22:46 cdeluca Exp $

\section{Overview of Infrastructure Data Classes}

Field, Bundle, and Array objects provide data access and data 
handling methods.  Their methods are called both from user written
code and from other objects internal to the framework.

A Field object encapsulates computational and/or observational 
data together with its underlying grid or set of spatial locations.  
It contains an A {\tt Field} object provides the
application with both an overall logical view of the entire
dataset, as well as access to processor-local data after decomposition.
It provides methods for configuration, initialization, setting and
retrieving data values, data I/O, intercomponent data 
exchange, data regridding, and manipulation of attributes.

Groups of fields on the same underlying physical grid 
can be collected into a single object called a Bundle.  
A Bundle provides two major functions: it allows groups of 
Fields to be manipulated using a single identifier, for example during
export or import of data between components; and it allows
data from multiple fields to be packed together in memory 
for higher locality of reference and ease in subsetting operations.
Bundle objects contain methods for setting and retrieving constituent 
fields, import and export data exchange during intercomponent 
communication, regridding, data I/O, and reordering of data in memory.

\subsection{Distributed Data Methods}

Bundles, Fields, and Arrays all have versions of the following
communication methods.  These all involve movements of data between
DEs.  The first three are higher level functions which are intended to
map closely to needs of applications programs.  They are:

There is a common object handle, an {\tt ESMF\_RouteHandle}, which
allows the communication patterns to be precomputed during 
initialization and the information stored in that RouteHandle.
By specifying the correct RouteHandle at execution time, only
the source and destination data pointers must be supplied and the
runtime overhead is minimized.

\subsubsection{Halo}
\input{../Infrastructure/ArrayComm/doc/ArrayHalo_desc}

\subsubsection{Regrid}
\input{../Infrastructure/Regrid/doc/Regrid_desc}
\input{../Infrastructure/Regrid/doc/Regrid_usage.tex}

\subsubsection{Redist}
\input{../Infrastructure/ArrayComm/doc/ArrayRedist_desc}

\subsubsection{Lower Level Functions}
The last seven correspond closely to the lower level
MPI communications primitives.  They are:
\begin{description}
\item[Gather]
Reassembling data which is decomposed over a set of DEs into a single
block of data on one DE.
\item[AllGather]
Reassembling data which is decomposed over a set of DEs into multiple
copies of a single block of data, one copy per original DE.
\item[Scatter]
Spreading an undecomposed block of data on one DE over a set of DEs,
decomposing that single block into smaller subsets of data, one
data decomposition per DE.
\item[AlltoAll]
Spreading an undecomposed block of data from multiple DEs onto
each of the other DEs in the set, resulting in a set of multiple decomposed 
data blocks per DE, one from each of the original source DEs.
\item[Broadcast]
Spreading an undecomposed block of data from one DE onto all other
DEs, where the resulting data is still undecomposed and simply
copied to all other DEs.
\item[Reduction]
Computing a single data value, e.g. the data maximum, minimum, sum, etc
from a group of decomposed data blocks across a set of DEs, where the
result is delivered to a single DE.
\item[AllReduce]
Computing a single data value, e.g. the data maximum, minimum, sum, etc
from a group of decomposed data blocks across a set of DEs, where the
result is delivered to all DEs in the set.
\end{description}

\subsection{Field and Bundle Attributes}

There are routines for setting and getting single values and lists of
int/I4, double/R8, and logical (ESMF\_Logical) types, and char */character
strings.  (Arrays of character strings are not supported.)

Attributes can be gotten by name.  The type and count can also be queried
by name and then a specific Get call can be made.  (The arguments to the
Get routines are typed and overloaded, so the type of the Attribute must
match the type of the argument receiving it.)

A count of all Attributes associated with an object can be returned, and
then Attributes can also be queried and retrieved by number, for iterating
an unknown Attribute list.

Currently Fields, Bundles, and States have Attribute support enabled.

\input{ESMF_infradatafparam}

\newpage
\subsection{Object Model}

The following is a simplified UML diagram showing the relationships among
ESMF Field, Grid and Bundle classes.  See Appendix A, {\it A Brief 
Introduction to UML},
for a translation table that lists the symbols in the diagram and their 
meaning.

\begin{center}
\includegraphics{Bundle_obj.eps}   
\end{center}

