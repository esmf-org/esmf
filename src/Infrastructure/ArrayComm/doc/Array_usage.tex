% $Id: Array_usage.tex,v 1.3 2004/04/22 17:53:44 nscollins Exp $

%\subsection{Usage}

The variants of the ESMF\_Array creation method include 2 language interfaces, 
3 allocation options, and 3 data type/kind/rank (TKR) specification options.  
From C++ the Create options are to specify
either the type/kind/rank explicitly, or specify an ESMF\_ArraySpec
object which contains this information.  The allocation options 
are either to allocate uninitialized space or allocate space and
copy data values into that space.  
From F90 the Create options
are to specify TKR either explicitly, with an ESMF\_ArraySpec
object, or to give a F90 array pointer which is queried by the
Framework.  The allocation options are to allocate uninitialized
space, to allocate space and copy data values into it, or to
reference already allocated data space.
The Create method is overloaded in F90 with an interface block.

The Get/Set methods support returning either a pointer to
the existing space, or allocating a new copy of the data
and returning a pointer to the copy.  From C++, the return 
value is a {\tt void *} pointer to the start of the data.
From F90, the return value is a Fortran 90 pointer to a
specific TRK array.  This allows standard F90 array manipulations
to be performed on the data without intervention of the Framework.

The general allocation/deallocation rules are: if the ESMF Framework
allocated the space at Create time then the Array Destroy routine 
will deallocate the space at the time the Array object is deleted.  
If the user allocated the space by specifying the data 
reference option to the Array Create method then  
the space will not
be deallocated by the Framework. The user is responsible
for calling the corresponding language routine to return the
space to the heap.  If the user requests a copy of the data with
a call to the ArrayGetData routine, they assume ownership of
the copied buffer and are responsible for deallocating the space.


